{% extends 'publicBase.html' %}
{% block title %}Sign Up - Todo App{% endblock %}
{% block content %}

<div class="min-h-screen bg-gray-950 flex items-center justify-center px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 max-w-6xl w-full">
        <div class="flex flex-col justify-center space-y-8">
            <div>
                <h1 class="text-5xl font-bold text-white mb-3">Create Account</h1>
                <p class="text-gray-400 text-lg">Join us to manage your todos efficiently.</p>
            </div>

            <div class="space-y-6 max-w-sm">
                {% if messages %}
                    {% for message in messages %}
                        <div class="p-4 rounded-lg {% if message.tags %}bg-red-900 border border-red-700 text-red-200{% else %}bg-green-900 border border-green-700 text-green-200{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}

                <form method="post" class="space-y-4">
                    {% csrf_token %}
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Full Name</label>
                        <input type="text" name="full_name" placeholder="Your full name" required class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                        <input type="email" name="email" placeholder="Your email address" required class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                        <div class="relative">
                            <input type="password" name="password" placeholder="Create a password" required id="password" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition">
                            <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300" onclick="togglePassword()">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="mt-2 space-y-2">
                            <div class="flex items-center gap-2">
                                <div id="password-strength-bar" class="flex-1 h-1 bg-gray-700 rounded-full overflow-hidden">
                                    <div id="password-strength-fill" class="h-full w-0 transition-all duration-300"></div>
                                </div>
                                <span id="password-strength-text" class="text-xs text-gray-400"></span>
                            </div>
                            <ul id="password-requirements" class="text-xs space-y-1">
                                <li class="flex items-center gap-2 text-gray-400">
                                    <span id="req-length" class="inline-block w-4 h-4 rounded-full border border-gray-600 flex items-center justify-center text-xs">○</span>
                                    At least 6 characters
                                </li>
                                <li class="flex items-center gap-2 text-gray-400">
                                    <span id="req-uppercase" class="inline-block w-4 h-4 rounded-full border border-gray-600 flex items-center justify-center text-xs">○</span>
                                    One uppercase letter
                                </li>
                                <li class="flex items-center gap-2 text-gray-400">
                                    <span id="req-number" class="inline-block w-4 h-4 rounded-full border border-gray-600 flex items-center justify-center text-xs">○</span>
                                    One number
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Confirm Password</label>
                        <div class="relative">
                            <input type="password" name="password_confirm" placeholder="Confirm your password" required id="password_confirm" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition">
                            <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300" onclick="togglePasswordConfirm()">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="mt-2">
                            <p id="password-match-status" class="text-sm hidden flex items-center gap-2"></p>
                        </div>
                    </div>

                    <div class="flex items-center pt-2">
                        <input type="checkbox" id="terms" required class="w-4 h-4 rounded border-gray-600 bg-gray-800 checked:bg-purple-600 cursor-pointer">
                        <label for="terms" class="ml-2 text-sm text-gray-400">
                            I agree to the <a href="#" class="text-purple-400 hover:text-purple-300 transition">Terms</a> and <a href="#" class="text-purple-400 hover:text-purple-300 transition">Privacy Policy</a>
                        </label>
                    </div>

                    <button type="submit" class="w-full gradient-bg text-white font-semibold py-3 rounded-lg hover:opacity-90 transition duration-200 mt-6">
                        Create Account
                    </button>
                </form>

                <div class="text-center text-gray-400 text-sm">
                    Already have an account? <a href="{% url 'login' %}" class="text-purple-400 hover:text-purple-300 font-semibold transition">Log in</a>
                </div>
            </div>
        </div>

        <div class="hidden lg:flex items-center justify-center">
            <div class="relative w-full h-96">
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="relative w-48 h-48">
                        <div class="absolute inset-0 bg-gradient-to-br from-purple-500/20 to-transparent rounded-lg transform -rotate-6 blur-2xl"></div>
                        
                        <div class="relative w-full h-full border-2 border-purple-500/30 rounded-lg bg-gradient-to-br from-purple-900/20 to-transparent backdrop-blur-sm transform perspective">
                            <div class="absolute inset-2 border border-purple-400/20 rounded-lg"></div>
                            <div class="absolute top-4 right-4 w-3 h-3 rounded-full bg-purple-400/60"></div>
                            <div class="absolute bottom-6 left-4 w-2 h-2 rounded-full bg-purple-300/40"></div>
                            <div class="absolute top-1/2 right-6 w-2 h-2 rounded-full bg-purple-400/50"></div>
                        </div>
                        <div class="absolute inset-0 border border-purple-500/20 rounded-full transform scale-150 animate-pulse"></div>
                    </div>
                </div>

                <div class="absolute inset-0 flex flex-col items-center justify-end text-center pb-8">
                    <p class="text-3xl font-bold text-gray-300 mb-2">400K+ users. 50M+ AI</p>
                    <p class="text-gray-500 text-lg">generated graphics.</p>
                </div>
            </div>
        </div>
    </div>
    <script>
        function togglePassword() {
            const input = document.getElementById('password');
            input.type = input.type === 'password' ? 'text' : 'password';
        }
        function togglePasswordConfirm() {
            const input = document.getElementById('password_confirm');
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        const passwordInput = document.getElementById('password');
        const passwordConfirmInput = document.getElementById('password_confirm');
        const passwordStrengthBar = document.getElementById('password-strength-bar');
        const passwordStrengthFill = document.getElementById('password-strength-fill');
        const passwordStrengthText = document.getElementById('password-strength-text');
        const passwordMatchStatus = document.getElementById('password-match-status');
        const registerForm = document.querySelector('form');
        const submitButton = registerForm.querySelector('button[type="submit"]');
        const reqLength = document.getElementById('req-length');
        const reqUppercase = document.getElementById('req-uppercase');
        const reqNumber = document.getElementById('req-number');

        function validatePasswordStrength(password) {
            let strength = 0;
            const requirements = {
                length: password.length >= 6,
                uppercase: /[A-Z]/.test(password),
                number: /\d/.test(password)
            };

            if (requirements.length) strength += 33;
            if (requirements.uppercase) strength += 33;
            if (requirements.number) strength += 34;

            updateRequirementUI(reqLength, requirements.length);
            updateRequirementUI(reqUppercase, requirements.uppercase);
            updateRequirementUI(reqNumber, requirements.number);

            passwordStrengthFill.style.width = strength + '%';
            
            if (strength === 0) {
                passwordStrengthFill.className = 'h-full w-0 transition-all duration-300 bg-gray-600';
                passwordStrengthText.textContent = '';
            } else if (strength < 50) {
                passwordStrengthFill.className = 'h-full transition-all duration-300 bg-red-500';
                passwordStrengthText.textContent = 'Weak';
                passwordStrengthText.className = 'text-xs text-red-400';
            } else if (strength < 100) {
                passwordStrengthFill.className = 'h-full transition-all duration-300 bg-yellow-500';
                passwordStrengthText.textContent = 'Fair';
                passwordStrengthText.className = 'text-xs text-yellow-400';
            } else {
                passwordStrengthFill.className = 'h-full transition-all duration-300 bg-green-500';
                passwordStrengthText.textContent = 'Strong';
                passwordStrengthText.className = 'text-xs text-green-400';
            }

            return requirements;
        }

        function updateRequirementUI(element, isMet) {
            if (isMet) {
                element.textContent = '✓';
                element.className = 'inline-block w-4 h-4 rounded-full border border-green-500 flex items-center justify-center text-xs text-green-500 bg-green-500/10';
                element.parentElement.classList.remove('text-gray-400');
                element.parentElement.classList.add('text-green-400');
            } else {
                element.textContent = '○';
                element.className = 'inline-block w-4 h-4 rounded-full border border-gray-600 flex items-center justify-center text-xs text-gray-400';
                element.parentElement.classList.remove('text-green-400');
                element.parentElement.classList.add('text-gray-400');
            }
        }

        function validatePasswordMatch() {
            const password = passwordInput.value;
            const passwordConfirm = passwordConfirmInput.value;

            if (!passwordConfirm) {
                passwordMatchStatus.classList.add('hidden');
                passwordConfirmInput.classList.remove('border-red-500', 'border-green-500');
                passwordConfirmInput.classList.add('border-gray-700');
                return false;
            }

            passwordMatchStatus.classList.remove('hidden');
            const matches = password === passwordConfirm;

            if (matches && password.length > 0) {
                passwordMatchStatus.innerHTML = '<span class="text-green-400">✓ Passwords match</span>';
                passwordMatchStatus.classList.add('text-green-400');
                passwordMatchStatus.classList.remove('text-red-400');
                passwordConfirmInput.classList.remove('border-red-500');
                passwordConfirmInput.classList.add('border-green-500');
            } else if (!matches && passwordConfirm.length > 0) {
                passwordMatchStatus.innerHTML = '<span class="text-red-400">✗ Passwords do not match</span>';
                passwordMatchStatus.classList.remove('text-green-400');
                passwordMatchStatus.classList.add('text-red-400');
                passwordConfirmInput.classList.remove('border-green-500');
                passwordConfirmInput.classList.add('border-red-500');
            }

            return matches;
        }

        passwordInput.addEventListener('input', function() {
            validatePasswordStrength(this.value);
            validatePasswordMatch();
        });

        passwordConfirmInput.addEventListener('input', function() {
            validatePasswordMatch();
        });
    </script>
</div>
{% endblock %}
